AnalysisDefaults:
  DefaultNewSheetConfiguration:
    InteractiveLayoutConfiguration:
      Grid:
        CanvasSizeOptions:
          ScreenCanvasSizeOptions:
            OptimizedViewPortWidth: 1600px
            ResizeOption: FIXED
    SheetContentType: INTERACTIVE
CalculatedFields:
- DataSetIdentifier: rls_dataset
  Expression: |-
    concat(
        ifelse(
                (isNotNull(UserName) AND UserName <> '') AND NOT (isNotNull(GroupName) AND GroupName <> ''), 'User has ',
            NOT (isNotNull(UserName) AND UserName <> '') AND     (isNotNull(GroupName) AND GroupName <> ''), 'Group has ',
                (isNotNull(UserName) AND UserName <> '') AND NOT (isNotNull(GroupName) AND GroupName <> ''), 'User in Group have ',
            'ANY USER have '
        ),
        ifelse(
            {_account_id_is_null} = 1 AND {_payer_id_is_null} = 1, 'Full Access (All Payers all Accounts)',
            {_account_id_is_null} = 1 AND {_payer_id_is_null} = 0, ifelse(contains({payer_id}, ','),
                                                                        concat('Access To Payers: ', {payer_id}),
                                                                        concat('Access To Payer: ', {payer_id})
            ),
            {_account_id_is_null} = 0 AND {_payer_id_is_null} = 1, ifelse(contains({account_id}, ','),
                                                                        concat('Access To Account: ', {account_id}),
                                                                        concat('Access To Account: ', {account_id})
            ),
            ''
        )
    )
  Name: Description
- DataSetIdentifier: rls_dataset
  Expression: ifelse(isNull({account_id}) OR {account_id} = '', 1, 0)
  Name: _account_id_is_null
- DataSetIdentifier: rls_dataset
  Expression: ifelse(isNull({payer_id}) OR {payer_id} = '', 1, 0)
  Name: _payer_id_is_null
ColumnConfigurations:
- Column:
    ColumnName: account_id
    DataSetIdentifier: rls_all_users_view
  FormatConfiguration:
    StringFormatConfiguration: {}
- Column:
    ColumnName: groupname
    DataSetIdentifier: rls_all_users_view
  FormatConfiguration:
    StringFormatConfiguration: {}
- Column:
    ColumnName: payer_id
    DataSetIdentifier: rls_all_users_view
  FormatConfiguration:
    StringFormatConfiguration: {}
- Column:
    ColumnName: UserName
    DataSetIdentifier: rls_dataset
  FormatConfiguration:
    StringFormatConfiguration: {}
- Column:
    ColumnName: account_id
    DataSetIdentifier: rls_dataset
  FormatConfiguration:
    StringFormatConfiguration: {}
- Column:
    ColumnName: payer_id
    DataSetIdentifier: rls_dataset
  FormatConfiguration:
    StringFormatConfiguration: {}
DataSetIdentifierDeclarations:
- DataSetArn: arn:aws:quicksight:::dataset/770b6f30-9498-49e2-9878-5ac9e3258b2c
  Identifier: rls_dataset
- DataSetArn: arn:aws:quicksight:::dataset/0414c907-daaf-46f7-9ae4-f922c198faa4
  Identifier: rls_all_users_view
FilterGroups:
- CrossDataset: SINGLE_DATASET
  FilterGroupId: 66362af8-4aa2-4391-b834-54d539b70bdf
  Filters:
  - CategoryFilter:
      Column:
        ColumnName: email
        DataSetIdentifier: rls_all_users_view
      Configuration:
        FilterListConfiguration:
          MatchOperator: CONTAINS
          NullOption: NON_NULLS_ONLY
          SelectAllOptions: FILTER_ALL_VALUES
      FilterId: c6e3fb9f-5cb1-485f-ae5c-4810829526a1
  ScopeConfiguration:
    SelectedSheets:
      SheetVisualScopingConfigurations:
      - Scope: SELECTED_VISUALS
        SheetId: 1f56cca7-d6c4-4b82-84e7-4741cb3582d0
        VisualIds:
        - 8cc77b33-cb36-497b-9fef-d3ccd97f867e
  Status: ENABLED
- CrossDataset: SINGLE_DATASET
  FilterGroupId: d0caea2c-0ccf-452f-900b-511d8cd90011
  Filters:
  - CategoryFilter:
      Column:
        ColumnName: groupname
        DataSetIdentifier: rls_all_users_view
      Configuration:
        FilterListConfiguration:
          MatchOperator: CONTAINS
          NullOption: NON_NULLS_ONLY
          SelectAllOptions: FILTER_ALL_VALUES
      FilterId: a28e5a72-170f-4a85-91cb-9c260ab72362
  ScopeConfiguration:
    SelectedSheets:
      SheetVisualScopingConfigurations:
      - Scope: SELECTED_VISUALS
        SheetId: 1f56cca7-d6c4-4b82-84e7-4741cb3582d0
        VisualIds:
        - 8cc77b33-cb36-497b-9fef-d3ccd97f867e
  Status: ENABLED
Options:
  WeekStart: SUNDAY
ParameterDeclarations: []
Sheets:
- ContentType: INTERACTIVE
  Layouts:
  - Configuration:
      GridLayout:
        CanvasSizeOptions:
          ScreenCanvasSizeOptions:
            OptimizedViewPortWidth: 1600px
            ResizeOption: FIXED
        Elements:
        - ColumnIndex: 0
          ColumnSpan: 36
          ElementId: a9d45e76-1669-4b1c-bf44-b526a1fa245a
          ElementType: TEXT_BOX
          RowIndex: 0
          RowSpan: 4
        - ColumnIndex: 0
          ColumnSpan: 36
          ElementId: 78602264-b797-4bc8-922c-76e2fd852742
          ElementType: VISUAL
          RowIndex: 4
          RowSpan: 17
  Name: RLS Dataset
  SheetId: 0146de27-2f7d-4268-9dd5-e7a5679a3d98
  TextBoxes:
  - Content: |-
      <text-box>
        <inline font-size="32px">RLS Dataset</inline>
        <br/>
        <br/>
        <ul>
          <li class="ql-indent-0">
            <b>No access</b>
            : Users not listed in the dataset will see empty dashboards
          </li>
          <li class="ql-indent-0">
            <b>Full access</b>
            : Users with empty account_id and payer_id fields have unrestricted access (recommended for Security, FinOps, and Platform teams)
          </li>
          <li class="ql-indent-0">
            <b>Organization access</b>
            : Users with empty account_id but populated payer_id have access to all accounts in the specified AWS Organization
          </li>
        </ul>
        <br/>
        See more in
        <a href="https://docs.aws.amazon.com/guidance/latest/cloud-intelligence-dashboards/row-level-security.html" target="_blank">documentation</a>
        .
      </text-box>
    SheetTextBoxId: a9d45e76-1669-4b1c-bf44-b526a1fa245a
  Visuals:
  - TableVisual:
      Actions: []
      ChartConfiguration:
        FieldOptions:
          SelectedFieldOptions:
          - FieldId: ba97c5ca-ff05-4d15-8cca-ffd0b8e3d804.UserName.0.1752384777900
            Width: 234px
          - FieldId: ba97c5ca-ff05-4d15-8cca-ffd0b8e3d804.GroupName.3.1765750843355
            Width: 156px
          - FieldId: ba97c5ca-ff05-4d15-8cca-ffd0b8e3d804.account_id.1.1752384782382
            Width: 136px
        FieldWells:
          TableAggregatedFieldWells:
            GroupBy:
            - CategoricalDimensionField:
                Column:
                  ColumnName: UserName
                  DataSetIdentifier: rls_dataset
                FieldId: ba97c5ca-ff05-4d15-8cca-ffd0b8e3d804.UserName.0.1752384777900
            - CategoricalDimensionField:
                Column:
                  ColumnName: GroupName
                  DataSetIdentifier: rls_dataset
                FieldId: ba97c5ca-ff05-4d15-8cca-ffd0b8e3d804.GroupName.3.1765750843355
            - CategoricalDimensionField:
                Column:
                  ColumnName: account_id
                  DataSetIdentifier: rls_dataset
                FieldId: ba97c5ca-ff05-4d15-8cca-ffd0b8e3d804.account_id.1.1752384782382
            - CategoricalDimensionField:
                Column:
                  ColumnName: payer_id
                  DataSetIdentifier: rls_dataset
                FieldId: ba97c5ca-ff05-4d15-8cca-ffd0b8e3d804.payer_id.2.1765750833895
            - CategoricalDimensionField:
                Column:
                  ColumnName: Description
                  DataSetIdentifier: rls_dataset
                FieldId: 8c712ab3-0b62-4fa5-9b4f-09aada6eda7a.4.1765780070945
            Values: []
        SortConfiguration: {}
        TableOptions:
          CellStyle:
            Height: 25
          HeaderStyle:
            Height: 25
            TextWrap: WRAP
      ConditionalFormatting:
        ConditionalFormattingOptions:
        - Cell:
            FieldId: ba97c5ca-ff05-4d15-8cca-ffd0b8e3d804.account_id.1.1752384782382
            TextFormat:
              Icon:
                CustomCondition:
                  DisplayConfiguration:
                    IconDisplayOption: ICON_ONLY
                  Expression: SUM({_account_id_is_null}) = 1
                  IconOptions:
                    UnicodeIcon: "\u26A0\uFE0F"
        - Cell:
            FieldId: ba97c5ca-ff05-4d15-8cca-ffd0b8e3d804.payer_id.2.1765750833895
            TextFormat:
              Icon:
                CustomCondition:
                  DisplayConfiguration:
                    IconDisplayOption: ICON_ONLY
                  Expression: SUM({_payer_id_is_null}) = 1
                  IconOptions:
                    UnicodeIcon: "\u26A0\uFE0F"
      Subtitle:
        Visibility: VISIBLE
      Title:
        FormatText:
          RichText: <visual-title>RLS Dataset</visual-title>
        Visibility: VISIBLE
      VisualId: 78602264-b797-4bc8-922c-76e2fd852742
- ContentType: INTERACTIVE
  FilterControls:
  - Dropdown:
      DisplayOptions:
        InfoIconLabelOptions:
          Visibility: HIDDEN
        SelectAllOptions:
          Visibility: VISIBLE
        TitleOptions:
          FontConfiguration:
            FontSize:
              Relative: MEDIUM
          Visibility: VISIBLE
      FilterControlId: 10e48992-0f2d-4b1a-b2df-7778c1def6ca
      SourceFilterId: c6e3fb9f-5cb1-485f-ae5c-4810829526a1
      Title: Email
      Type: MULTI_SELECT
  - Dropdown:
      DisplayOptions:
        InfoIconLabelOptions:
          Visibility: HIDDEN
        SelectAllOptions:
          Visibility: VISIBLE
        TitleOptions:
          FontConfiguration:
            FontSize:
              Relative: MEDIUM
          Visibility: VISIBLE
      FilterControlId: d6b77184-93c4-4063-8ec8-0754551ef149
      SourceFilterId: a28e5a72-170f-4a85-91cb-9c260ab72362
      Title: Group
      Type: MULTI_SELECT
  Layouts:
  - Configuration:
      GridLayout:
        CanvasSizeOptions:
          ScreenCanvasSizeOptions:
            OptimizedViewPortWidth: 1600px
            ResizeOption: FIXED
        Elements:
        - ColumnIndex: 0
          ColumnSpan: 36
          ElementId: 8cc77b33-cb36-497b-9fef-d3ccd97f867e
          ElementType: VISUAL
          RowIndex: 0
          RowSpan: 12
  Name: Users
  SheetControlLayouts:
  - Configuration:
      GridLayout:
        Elements:
        - ColumnSpan: 2
          ElementId: 10e48992-0f2d-4b1a-b2df-7778c1def6ca
          ElementType: FILTER_CONTROL
          RowSpan: 1
        - ColumnSpan: 2
          ElementId: d6b77184-93c4-4063-8ec8-0754551ef149
          ElementType: FILTER_CONTROL
          RowSpan: 1
  SheetId: 1f56cca7-d6c4-4b82-84e7-4741cb3582d0
  Visuals:
  - PivotTableVisual:
      Actions: []
      ChartConfiguration:
        FieldOptions:
          DataPathOptions:
          - DataPathList:
            - FieldId: rls_all_u-email-2b3908.0.1765803192622
              FieldValue: email
            Width: 267px
          - DataPathList:
            - FieldId: rls_all_u-username-6976b4.1.1765803201724
              FieldValue: username
            Width: 262px
          - DataPathList:
            - FieldId: rls_all_u-groupname-afb520.4.1765803219996
              FieldValue: groupname
            Width: 193px
          - DataPathList:
            - DataPathType:
                PivotTableDataPathType: COUNT_METRIC_COLUMN
            Width: 147px
          - DataPathList:
            - FieldId: rls_all_u-account_i-616da3.3.1765803217027
              FieldValue: account_id
            Width: 136px
          - DataPathList:
            - FieldId: rls_all_u-payer_id-133248.2.1765803215132
              FieldValue: payer_id
            Width: 131px
          SelectedFieldOptions:
          - FieldId: rls_all_u-email-2b3908.0.1765803192622
            Visibility: VISIBLE
          - FieldId: rls_all_u-username-6976b4.1.1765803201724
            Visibility: VISIBLE
          - FieldId: rls_all_u-groupname-afb520.4.1765803219996
            Visibility: VISIBLE
          - FieldId: rls_all_u-payer_id-133248.2.1765803215132
            Visibility: VISIBLE
          - FieldId: rls_all_u-account_i-616da3.3.1765803217027
            Visibility: VISIBLE
          - FieldId: rls_all_u-permissio-becbbc.5.1765803387807
            Visibility: VISIBLE
        FieldWells:
          PivotTableAggregatedFieldWells:
            Columns: []
            Rows:
            - CategoricalDimensionField:
                Column:
                  ColumnName: email
                  DataSetIdentifier: rls_all_users_view
                FieldId: rls_all_u-email-2b3908.0.1765803192622
            - CategoricalDimensionField:
                Column:
                  ColumnName: username
                  DataSetIdentifier: rls_all_users_view
                FieldId: rls_all_u-username-6976b4.1.1765803201724
            - CategoricalDimensionField:
                Column:
                  ColumnName: groupname
                  DataSetIdentifier: rls_all_users_view
                FieldId: rls_all_u-groupname-afb520.4.1765803219996
            - CategoricalDimensionField:
                Column:
                  ColumnName: payer_id
                  DataSetIdentifier: rls_all_users_view
                FieldId: rls_all_u-payer_id-133248.2.1765803215132
            - CategoricalDimensionField:
                Column:
                  ColumnName: account_id
                  DataSetIdentifier: rls_all_users_view
                FieldId: rls_all_u-account_i-616da3.3.1765803217027
            - CategoricalDimensionField:
                Column:
                  ColumnName: permission_type
                  DataSetIdentifier: rls_all_users_view
                FieldId: rls_all_u-permissio-becbbc.5.1765803387807
            Values: []
        SortConfiguration:
          FieldSortOptions:
          - FieldId: rls_all_u-email-2b3908.0.1765803192622
            SortBy:
              Field:
                Direction: ASC
                FieldId: rls_all_u-email-2b3908.0.1765803192622
        TableOptions:
          CellStyle: {}
          CollapsedRowDimensionsVisibility: HIDDEN
          ColumnHeaderStyle:
            Height: 25
          RowAlternateColorOptions:
            Status: DISABLED
            UsePrimaryBackgroundColor: ENABLED
          RowFieldNamesStyle:
            Height: 25
          RowsLayout: TABULAR
          ToggleButtonsVisibility: VISIBLE
        TotalOptions:
          ColumnTotalOptions:
            Placement: END
          RowSubtotalOptions:
            CustomLabel: <<$aws:subtotalDimension>> Subtotal
            MetricHeaderCellStyle: {}
            StyleTargets:
            - CellType: VALUE
            - CellType: TOTAL
            - CellType: METRIC_HEADER
            TotalCellStyle: {}
            TotalsVisibility: HIDDEN
            ValueCellStyle: {}
          RowTotalOptions:
            Placement: AUTO
      Subtitle:
        Visibility: VISIBLE
      Title:
        FormatText:
          RichText: <visual-title>RLS Users and Group Membership</visual-title>
        Visibility: VISIBLE
      VisualId: 8cc77b33-cb36-497b-9fef-d3ccd97f867e
- ContentType: INTERACTIVE
  Layouts:
  - Configuration:
      GridLayout:
        CanvasSizeOptions:
          ScreenCanvasSizeOptions:
            OptimizedViewPortWidth: 1600px
            ResizeOption: FIXED
        Elements:
        - ColumnIndex: 0
          ColumnSpan: 36
          ElementId: b31933cc-2fec-4b5c-beb7-8226c408eb42
          ElementType: TEXT_BOX
          RowIndex: 0
          RowSpan: 9
  Name: About
  SheetId: 99a5bb68-44fd-4454-bf78-545d5fb14f35
  TextBoxes:
  - Content: "<text-box>\n  <block align=\"center\"/>\n  <br/>\n  <block align=\"\
      center\"/>\n  <br/>\n  <block align=\"center\">\n    <inline font-size=\"32px\"\
      >CID Row Level Security Dashboard</inline>\n  </block>\n  <br/>\n  <block align=\"\
      center\">\n    <inline font-size=\"20px\">v0.0.1\_</inline>\n  </block>\n  <br/>\n\
      \  <block align=\"center\"/>\n  <br/>\n  <block align=\"center\">\n    <inline\
      \ font-size=\"20px\">This dashboard visualizes RLS dataset for using in Row\
      \ Level Security process</inline>\n  </block>\n  <br/>\n  <block align=\"center\"\
      />\n  <br/>\n  <block align=\"center\">\n    <inline font-size=\"20px\">[</inline>\n\
      \    <inline font-size=\"20px\">\n      <a href=\"https://docs.aws.amazon.com/guidance/latest/cloud-intelligence-dashboards/row-level-security.html\"\
      \ target=\"_blank\">Documentation</a>\n    </inline>\n    <inline font-size=\"\
      20px\">]</inline>\n  </block>\n  <br/>\n  <block align=\"center\"/>\n  <br/>\n\
      \  <block align=\"center\"/>\n  <br/>\n  <block align=\"center\"/>\n  <br/>\n\
      \  <block align=\"right\">Author: Iakov Gan</block>\n</text-box>"
    SheetTextBoxId: b31933cc-2fec-4b5c-beb7-8226c408eb42
  Visuals: []
